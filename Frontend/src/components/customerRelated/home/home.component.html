<!-- home.component.html -->
<div class="home-root container py-5">
  <!-- Top: Welcome + profile quick actions -->
  <div class="d-flex justify-content-between align-items-start mb-4 flex-wrap gap-3">
    <div class="user-info">
      <h1 class="welcome mb-1">Welcome, {{ user.firstName }}</h1>
      <div class="muted small">
        <div>Account No: <strong>{{ user.accountNumber }}</strong></div>
        <div>Billing Address: <span class="d-block text-truncate" style="max-width:420px">{{ user.billingAddress }}</span></div>
      </div>
    </div>

    <div class="action-buttons d-flex align-items-center gap-2">
      <a class="btn btn-outline-secondary btn-sm" href="/profile" title="Profile / Account settings">
        <i class="bi bi-person-circle me-1"></i> Profile
      </a>
      <button class="btn btn-danger btn-sm" (click)="logout()" title="Logout">
        <i class="bi bi-box-arrow-right me-1"></i> Logout
      </button>
    </div>
  </div>

  <div class="row gx-4 gy-4">
    <!-- Left column: Current bill summary -->
    <div class="col-lg-4">
      <div class="card card-panel shadow-sm">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-start mb-2">
            <h5 class="card-title mb-0">Current Bill</h5>
            <small class="text-muted">Latest</small>
          </div>

          <div *ngIf="currentBill; else noBill" class="bill-details">
            <div class="d-flex justify-content-between mb-2">
              <small class="text-muted">Billing Period</small>
              <div><strong>{{ currentBill.period }}</strong></div>
            </div>

            <div class="d-flex justify-content-between mb-2">
              <small class="text-muted">Due Date</small>
              <div><strong>{{ currentBill.dueDate | date:'longDate' }}</strong></div>
            </div>

            <div class="d-flex justify-content-between align-items-center mt-3 mb-3 bill-amount">
              <div>
                <small class="text-muted">Amount Due</small>
                <div class="h4 mb-0">â‚¹ {{ currentBill.amount | number:'1.2-2' }}</div>
              </div>

              <div class="text-end">
                <span class="badge" [ngClass]="currentBill.paid ? 'bg-success' : 'bg-warning text-dark'">
                  {{ currentBill.paid ? 'Paid' : 'Unpaid' }}
                </span>
              </div>
            </div>

            <div class="d-flex gap-2">
              <a *ngIf="!currentBill.paid" class="btn btn-primary btn-sm flex-grow-1" href="/pay" title="Pay now">
                Pay Now
              </a>
              <a class="btn btn-outline-secondary btn-sm" href="/bill-details" title="View bill details">
                View
              </a>
            </div>
          </div>

          <ng-template #noBill>
            <div class="text-muted">No current bills available.</div>
          </ng-template>
        </div>
      </div>

      <!-- Quick links / small widgets -->
      <div class="card mt-3 shadow-sm">
        <div class="card-body small">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <i class="bi bi-clock-history fs-4 me-2"></i>
              <div class="d-inline-block align-middle">View Bill History</div>
            </div>
            <a class="text-primary" href="/history">Open</a>
          </div>
        </div>
      </div>
    </div>

    <!-- Right column: Feature cards -->
    <div class="col-lg-8">
      <div class="row gx-3 gy-3">
        <div class="col-md-6" *ngFor="let feature of features">
          <a [href]="feature.route" class="card feature-card h-100 text-decoration-none">
            <div class="card-body d-flex gap-3 align-items-start">
              <div class="icon-wrap">
                <i [class]="feature.icon + ' feature-icon'"></i>
              </div>
              <div class="flex-grow-1">
                <h6 class="mb-1 feature-title">{{ feature.title }}</h6>
                <p class="mb-0 small text-muted">{{ feature.description }}</p>
              </div>
              <div class="align-self-center">
                <i class="bi bi-chevron-right text-muted"></i>
              </div>
            </div>
          </a>
        </div>
      </div>
    </div>
  </div>
</div>
