<nav class="wm-navbar">
  <div class="wm-container">
    <div class="brand">
      <div class="logo" aria-hidden="true">
        <!-- simple bolt icon -->
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" class="bolt">
          <path d="M13 2L3 14h7l-1 8 10-12h-7l1-8z" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
       <a href="/"><span class="brand-name">PowerEase</span></a>
    </div>

    <ul class="nav-links">
      <li><a routerLink="/customer/home" style="color: #0EA5A4;">Home</a></li>
      <li><a routerLink="/customer/pay-bill">Pay Bill</a></li>
      <li><a routerLink="/customer/complaint-status">Search Complaint</a></li>
      <li><a routerLink="/customer/register-complaint" style="color:red">Register Complaint</a></li>
    </ul>
  </div>
</nav>

<div class="container mt-5 text-center">
  <h2 class="welcome-heading mb-4">Bill Summary</h2>

  <div *ngIf="loading">Loading your bills...</div>
  <div *ngIf="errorMessage" class="alert alert-danger">{{ errorMessage }}</div>

  <!-- Bill Table -->
  <table class="table table-bordered table-hover" *ngIf="bills.length > 0">
    <thead class="table-primary">
      <tr>
        <th>Select</th>
        <th>Bill Number</th>
        <th>Bill Period</th>
        <th>Bill Date</th>
        <th>Due Date</th>
        <th>Due Amount</th>
        <th>Payable Amount</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let bill of bills">
        <td>
          <input
            type="checkbox"
            (change)="toggleBillSelection(bill, $event)"
          />
        </td>
        <td>{{ bill.billNumber }}</td>
        <td>{{ bill.billPeriod }}</td>
        <td>{{ bill.billDate | date }}</td>
        <td>{{ bill.dueDate | date }}</td>
        <td>{{ bill.dueAmount | currency: "INR" }}</td>
        <td>{{ bill.payableAmount | currency: "INR" }}</td>
      </tr>
    </tbody>
  </table>

  <div *ngIf="bills.length === 0 && !loading" class="alert alert-info mt-4">
    No bills found for this consumer.
  </div>

  <!-- Total and Payment -->
  <div *ngIf="selectedBills.length > 0" class="mt-4">
    <h4>Total Payable: {{ totalPayable | currency: "INR" }}</h4>
    <button class="btn btn-success mt-3" (click)="processPayment()">
      Pay Now
    </button>
  </div>

  <!-- Payment Success Message -->
  <div *ngIf="paymentSuccess" class="mt-5 alert alert-success">
    <h5>âœ… Payment Successful!</h5>
    <p>Transaction ID: {{ transactionId }}</p>
    <p>Receipt Number: {{ receiptNumber }}</p>
    <p>Transaction Amount: {{ totalPayable | currency: "INR" }}</p>

    <button class="btn btn-outline-primary mt-3" (click)="downloadInvoice()">
      Download Invoice (PDF)
    </button>
  </div>
</div>
