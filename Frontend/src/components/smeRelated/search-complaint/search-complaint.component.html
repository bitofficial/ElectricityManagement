<div class="container mt-4">
  <h2 class="text-center mb-4">üîç Search Complaint</h2>

  <!-- Search Form -->
  <div class="card shadow p-4 mb-4">
    <form (ngSubmit)="searchComplaint()" #searchForm="ngForm">
      <div class="row align-items-end">
        <div class="col-md-8 mb-3">
          <label for="complaintId" class="form-label">Enter Complaint ID / Consumer ID</label>
          <input
            type="text"
            id="complaintId"
            class="form-control"
            placeholder="e.g., CMP202510 or CUST1001"
            [(ngModel)]="searchKey"
            name="complaintId"
            required
          />
        </div>
        <div class="col-md-4 mb-3 text-center">
          <button type="submit" class="btn btn-primary w-100" [disabled]="!searchForm.form.valid">
            Search
          </button>
        </div>
      </div>
    </form>
  </div>

  <!-- Complaint Details -->
  <div *ngIf="complaint" class="card shadow p-4">
    <h5 class="mb-3">Complaint Details</h5>

    <div class="row mb-2">
      <div class="col-md-6">
        <p><strong>Complaint ID:</strong> {{ complaint.id }}</p>
      </div>
      <div class="col-md-6 text-md-end">
        <p><strong>Consumer ID:</strong> {{ complaint.consumerId }}</p>
      </div>
    </div>

    <div class="row mb-2">
      <div class="col-md-6">
        <p><strong>Complaint Type:</strong> {{ complaint.type }}</p>
      </div>
      <div class="col-md-6 text-md-end">
        <p><strong>Date Filed:</strong> {{ complaint.dateFiled | date }}</p>
      </div>
    </div>

    <div class="row mb-2">
      <div class="col-md-12">
        <p><strong>Description:</strong> {{ complaint.description }}</p>
      </div>
    </div>

    <div class="row mb-2">
      <div class="col-md-6">
        <p><strong>Status:</strong>
          <span class="badge"
            [ngClass]="{
              'bg-warning': complaint.status === 'Pending',
              'bg-success': complaint.status === 'Resolved',
              'bg-danger': complaint.status === 'Rejected'
            }">
            {{ complaint.status }}
          </span>
        </p>
      </div>
      <div class="col-md-6 text-md-end">
        <p><strong>Assigned SME:</strong> {{ complaint.assignedTo }}</p>
      </div>
    </div>

    <div *ngIf="complaint.resolution" class="mt-3">
      <p><strong>Resolution:</strong> {{ complaint.resolution }}</p>
      <!-- <p><strong>Resolved Date:</strong> {{ complaint.resolvedDate | date }}</p> -->
      <p><strong>Resolved Date:</strong> {{ complaint.resolvedDate}}</p>
    </div>
  </div>

  <!-- Loader -->
  <div *ngIf="loading" class="text-center mt-4">
    <div class="spinner-border text-primary" role="status"></div>
    <p>Fetching complaint details...</p>
  </div>

  <!-- Error -->
  <div *ngIf="errorMessage" class="alert alert-danger text-center mt-3">
    ‚ùå {{ errorMessage }}
  </div>
</div>
